var McDonoughEats=function(){function e(e){setTimeout(function(){e.setAnimation(null)},1400)}var s,t,i=[{name:"Kirby G's",tel:"6785838777",visible:"TRUE"},{name:"Queen Bee Coffee",tel:"6788832233",visible:"TRUE"},{name:"Pasta Max",tel:"7703209311",visible:"TRUE"},{name:"South Side Diner",tel:"6787592690",visible:"TRUE"},{name:"Gritz",tel:"7709140448",visible:"TRUE"},{name:"Truett's Grill",tel:"6784322221",visible:"TRUE"},{name:"Deep South Deli",tel:"7703208999",visible:"TRUE"},{name:"Mikie's Big Burger",tel:"7709544306",visible:"TRUE"}],n=ko.observableArray(),o=ko.observable("http://www.yelp.com"),a=ko.observable("https://s3-media1.fl.yelpcdn.com/assets/srv0/developer_pages/dc8ff90d5d7d/assets/img/Powered_By_Yelp_Black.png"),r=ko.observable(""),l=i.length,c=(new google.maps.LatLngBounds,ko.observable("")),d=new google.maps.InfoWindow({content:""}),m=function(){s=new google.maps.Map(document.getElementById("mapBox"),{center:{lat:33.4469617,lng:-84.1419653},scrollwheel:!1,zoom:13,mapTypeId:google.maps.MapTypeId.TERRAIN})}(),u=function(){if(t)for(var e=0;e<t.length;e++)t[e].marker.setMap(null);t=[];var i=new google.maps.LatLngBounds;t=n.slice();for(var o=0;o<t.length;o++)t[o].marker=new google.maps.Marker({position:t[o].latlng,title:t[o].name,map:s,icon:"http://maps.google.com/mapfiles/kml/pal2/icon36.png",size:new google.maps.Size(120,32)}),i.extend(t[o].marker.getPosition()),p(t[o].marker,t[o]);if(t.length>1&&s.fitBounds(i),1===t.length){s.setZoom(19);var a=t[0].marker.getPosition();s.setCenter(a)}zoomListener=google.maps.event.addListenerOnce(s,"change zoom",function(e){s.setCenter(i.getCenter())}),setTimeout(function(){google.maps.event.removeListener(zoomListener)},2e3)},p=function(e,s){var t;e.addListener("click",function(){f(s,t)})},g=function(){n([]);for(var e=0;l>e;e++)"TRUE"==i[e].visible&&n.push(i[e]);n().length>=1&&n()[n().length-1].latitude&&u(),0===n().length&&u()},v=function(e,s){i[e].review_count=s.businesses[0].review_count,i[e].postal_code=s.businesses[0].location.postal_code,i[e].state_code=s.businesses[0].location.state_code,i[e].city=s.businesses[0].location.city,i[e].address=s.businesses[0].location.address,i[e].snippet_text=s.businesses[0].snippet_text,i[e].snippet_image_url=s.businesses[0].snippet_image_url,i[e].image_url=s.businesses[0].image_url,i[e].rating_img_url=s.businesses[0].rating_img_url,i[e].review_count=s.businesses[0].review_count,i[e].url=s.businesses[0].url,i[e].latitude=s.businesses[0].location.coordinate.latitude,i[e].longitude=s.businesses[0].location.coordinate.longitude,i[e].latlng={lat:i[e].latitude,lng:i[e].longitude},g()},h=0,b=function(){var e={consumerKey:"sB9MQlZkUAFlQR5P8iRwCw",consumerSecret:"HQb8up0L05VUZVjMEzAAxm_XIx4",accessToken:"7dsLP8pY0a17kCRjPlFlSIplD4l1J77c",accessTokenSecret:"sL9Hj1nFYN3HvRMKI4_ph8bvQdE",serviceProvider:{signatureMethod:"HMAC-SHA1"}},s={consumerSecret:e.consumerSecret,tokenSecret:e.accessTokenSecret};parameters=[],parameters.push(["phone",i[h].tel]),parameters.push(["callback","cb"]),parameters.push(["oauth_consumer_key",e.consumerKey]),parameters.push(["oauth_consumer_secret",e.consumerSecret]),parameters.push(["oauth_token",e.accessToken]),parameters.push(["oauth_signature_method","HMAC-SHA1"]);var t={action:"http://api.yelp.com/v2/phone_search?",method:"GET",parameters:parameters};OAuth.setTimestampAndNonce(t),OAuth.SignatureMethod.sign(t,s);var n=OAuth.getParameterMap(t.parameters);n.oauth_signature=OAuth.percentEncode(n.oauth_signature);var o=$.ajax({url:t.action,data:n,cache:!0,dataType:"jsonp",timeout:5e3});o.error(function(e,s){}),o.success(function(e){l>h&&(v(h,e),h++,l>h&&b())})};b();var _=function(){if(""===r.toLowerCase)for(var e=0;l>e;e++)i[e].visible="TRUE";for(var s=new RegExp($("#searchBox").val(),"i"),t=0;l>t;t++)s.test(i[t].name)?i[t].visible="TRUE":i[t].visible="FALSE";g()},f=function(i,n){k(i,n),c=null;var o;c=i.name;for(var r=0;r<t.length;r++)if(t[r].marker.setAnimation(null),t[r].name==c){var l=t[r].marker;l.setAnimation(google.maps.Animation.BOUNCE),e(l);var m=t[r].address+", "+t[r].city+", "+t[r].state_code+" "+t[r].postal_code,p="("+t[r].tel.slice(0,3)+") "+t[r].tel.slice(3,6)+"-"+t[r].tel.slice(6,10),g=t[r].snippet_text;o='<div id="infoWindowContainer"><h2 class="infoWindowHeader">'+c+'</h2><div class ="row" id="imageRow"><div class = "col-md-2 col-sm-2 col-xs-2" id = "restPic"><img src='+t[r].image_url+'></div><div class = "col-md-2 col-sm-2 col-xs-2" id = "snippetPic"><img class= "snippetPic" src='+t[r].snippet_image_url+'></div><div class =  "col-lg-8 hidden-md hidden-sm hidden-xs"><p id="introText"> Click the telephone number to call this restaurant, or click the link below for more information:</p><p class = "snippetText">'+g+'</p></div></div><div class = "row" id ="addressRow"><div class="col-lg-12 hidden-md hidden-sm hidden-xs"><p id="addressP"><b> Address: '+m+'</b></p></div></div><div class = "row" id = "phoneRow"><div class="col-md-12 col-sm-12 col-xs-12"><p id="phoneP"><b> Phone: <a href=tel:'+t[r].tel+">"+p+"</a></b></p></div></div><img src="+t[r].rating_img_url+">"+t[r].review_count+" reviews  <img src="+a()+"><p> <a href="+t[r].url+' target="_blank">Click here to visit this page on Yelp.com</p></a></div></div>',d.setContent(o),d.open(s,l),google.maps.event.addListener(d,"closeclick",function(){u()})}},k=function(e,s){window.innerWidth<1200&&($("#list").find("li").slideToggle("slow"),$("#rolldown").toggle("slow"))},w=function(){ko.applyBindings(McDonoughEats)};return $(w),{mrkerActivate:f,userInput:r,makeViz:_,yelpAttrib:o,yelpImgAttrib:a,workArray:n,makeMarker:u,initMap:m,map:s,updateWorkArray:g}}();